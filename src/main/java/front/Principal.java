/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package front;

import Connection.ConnectionFactory;
import model.*;
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Toolkit;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.geom.Line2D;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;
import model.bellman.ford.MetricaCalculo;
import model.bellman.ford.ResultCaminho;
/**
 *
 * @author 55119
 */
public class Principal extends javax.swing.JFrame{
    ApplicationFactory app = new ApplicationFactory(); //Aplicação do grafo
    ArrayList<Point> arrayPoints = new ArrayList(); //Armazenando pontos adicionados no mapa
    Color color_activated  = Color.BLUE; //Cor quando a aresta está ativada
    Color color_deactivated  = Color.RED; //Cor quando a aresta está desativada
    MetricaCalculo metrica = MetricaCalculo.CUSTO;
    int clicks = 0; //Ajuda a adicionar a aresta, sendo o segundo click em um vértice, que vai adicionar a aresta
    Vertice vertice_old = null;
    Vertice vertice_now = null;
    int x_now = 0;
    int y_now = 0;
    ConnectionFactory conn;
    boolean allow_add_points = false; //permitir adicionar vértice
    boolean allow_remove_points = false;
    boolean allow_add_conexion = false;
    boolean allow_remove_conexion = false;
    boolean allow_do_way_minimum = false;
    boolean allow_report_erro_point = false;
    boolean allow_report_erro_enlace = false;
    Graphics universal_graph; //grafico para desenhos das arestas e vértices
    Sobre sobre;
    ArrayList<Lines> arrayLines = new ArrayList();
    
    List<Aresta> conexoes = null;
    
    
    /**
     * Creates new form Principal
     */
    public Principal() throws Exception {
        conn = new ConnectionFactory();
        pack();
        initComponents();
        initComponents2();
        Listar.doClick();
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        Listar = new javax.swing.JButton();
        JScrollMap = new javax.swing.JScrollPane();
        PanelMap = new javax.swing.JPanel();
        Map = new javax.swing.JLabel();
        AdicionarPontos = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        AdicionarPontosButton = new javax.swing.JButton();
        ButtonCancel = new javax.swing.JButton();
        SiglaAdd = new javax.swing.JFormattedTextField();
        jLabel2 = new javax.swing.JLabel();
        ComboCitys = new javax.swing.JComboBox<>();
        jLabel3 = new javax.swing.JLabel();
        AdicionarEnlaces = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        AdicionarEnlaceButton = new javax.swing.JButton();
        ButtonCancel1 = new javax.swing.JButton();
        Hops = new javax.swing.JFormattedTextField();
        HopsLabel = new javax.swing.JLabel();
        CidadeCity1 = new javax.swing.JLabel();
        CidadeCity2 = new javax.swing.JLabel();
        SiglaCity2 = new javax.swing.JLabel();
        Distancia = new javax.swing.JFormattedTextField();
        Custo = new javax.swing.JFormattedTextField();
        SiglaCity1 = new javax.swing.JLabel();
        DistanciaLabel = new javax.swing.JLabel();
        CuatoLabel = new javax.swing.JLabel();
        BackgroundMap = new javax.swing.JLabel();
        SuperiorMenu = new javax.swing.JMenuBar();
        PontosMenu = new javax.swing.JMenu();
        AddPontos = new javax.swing.JMenuItem();
        RemovePontos = new javax.swing.JMenuItem();
        EnlacesMenu = new javax.swing.JMenu();
        AddEnlaces = new javax.swing.JMenuItem();
        RemoveEnlaces = new javax.swing.JMenuItem();
        CaminhoMinimo = new javax.swing.JMenu();
        AplicarDistancia = new javax.swing.JMenuItem();
        AplicarCusto = new javax.swing.JMenuItem();
        AplicarHops = new javax.swing.JMenuItem();
        ReportErro = new javax.swing.JMenu();
        ErroPonto = new javax.swing.JMenuItem();
        ErroEnlace = new javax.swing.JMenuItem();
        SobreMenu = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Projeto Roteamento");
        setBackground(new java.awt.Color(51, 51, 51));
        setMinimumSize(new java.awt.Dimension(905, 760));
        setResizable(false);
        setSize(new java.awt.Dimension(905, 760));
        getContentPane().setLayout(null);

        Listar.setBackground(new java.awt.Color(51, 51, 51));
        Listar.setForeground(new java.awt.Color(255, 255, 255));
        Listar.setText("Listar conexões");
        Listar.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        Listar.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        Listar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ListarMouseClicked(evt);
            }
        });
        getContentPane().add(Listar);
        Listar.setBounds(740, 10, 130, 20);

        JScrollMap.setBorder(null);
        JScrollMap.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        JScrollMap.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        JScrollMap.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        JScrollMap.setName("JScrollMap"); // NOI18N
        JScrollMap.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                JScrollMapMouseClicked(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                JScrollMapMouseReleased(evt);
            }
        });

        PanelMap.setBackground(new java.awt.Color(51, 51, 51));
        PanelMap.setAutoscrolls(true);
        PanelMap.setPreferredSize(new java.awt.Dimension(900, 900));
        PanelMap.setLayout(null);

        Map.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/mapa_esse.png"))); // NOI18N
        Map.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        Map.setEnabled(false);
        Map.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
        Map.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
            public void mouseMoved(java.awt.event.MouseEvent evt) {
                MapMouseMoved(evt);
            }
        });
        Map.addMouseWheelListener(new java.awt.event.MouseWheelListener() {
            public void mouseWheelMoved(java.awt.event.MouseWheelEvent evt) {
                MapMouseWheelMoved(evt);
            }
        });
        Map.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                MapMouseClicked(evt);
            }
        });
        Map.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                MapKeyPressed(evt);
            }
        });
        PanelMap.add(Map);
        Map.setBounds(0, 0, 900, 1200);

        JScrollMap.setViewportView(PanelMap);

        getContentPane().add(JScrollMap);
        JScrollMap.setBounds(0, 0, 900, 700);
        JScrollMap.getVerticalScrollBar().setEnabled(false);

        AdicionarPontos.setBackground(new java.awt.Color(0,0,0,200));
        AdicionarPontos.setEnabled(false);
        AdicionarPontos.setMinimumSize(new java.awt.Dimension(880, 934));
        AdicionarPontos.setName("AdicionarPontos"); // NOI18N
        AdicionarPontos.setPreferredSize(new java.awt.Dimension(880, 934));
        AdicionarPontos.setLayout(null);

        jPanel1.setBackground(new java.awt.Color(49, 49, 49));
        jPanel1.setLayout(null);

        AdicionarPontosButton.setBackground(new java.awt.Color(51, 51, 51));
        AdicionarPontosButton.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        AdicionarPontosButton.setText("Adicionar");
        AdicionarPontosButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AdicionarPontosButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                AdicionarPontosButtonMouseClicked(evt);
            }
        });
        AdicionarPontosButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AdicionarPontosButtonActionPerformed(evt);
            }
        });
        jPanel1.add(AdicionarPontosButton);
        AdicionarPontosButton.setBounds(20, 330, 250, 40);

        ButtonCancel.setBackground(new java.awt.Color(51, 51, 51));
        ButtonCancel.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        ButtonCancel.setText("Cancelar");
        ButtonCancel.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        ButtonCancel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ButtonCancelMouseClicked(evt);
            }
        });
        ButtonCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ButtonCancelActionPerformed(evt);
            }
        });
        jPanel1.add(ButtonCancel);
        ButtonCancel.setBounds(280, 330, 250, 40);

        SiglaAdd.setBackground(new java.awt.Color(204, 204, 204));
        SiglaAdd.setColumns(3);
        try {
            SiglaAdd.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("UUU")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        SiglaAdd.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        SiglaAdd.setText("");
        SiglaAdd.setToolTipText("");
        SiglaAdd.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        jPanel1.add(SiglaAdd);
        SiglaAdd.setBounds(170, 180, 220, 40);

        jLabel2.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("Sigla");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(250, 140, 60, 22);

        ComboCitys.setBackground(new java.awt.Color(204, 204, 204));
        ComboCitys.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        ComboCitys.setForeground(new java.awt.Color(0, 0, 0));
        ComboCitys.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ComboCitysActionPerformed(evt);
            }
        });
        jPanel1.add(ComboCitys);
        ComboCitys.setBounds(120, 60, 330, 40);

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("Cidade");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(250, 30, 60, 22);

        AdicionarPontos.add(jPanel1);
        jPanel1.setBounds(160, 190, 550, 390);

        getContentPane().add(AdicionarPontos);
        AdicionarPontos.setBounds(0, -50, 900, 980);
        AdicionarPontos.setVisible(false);

        AdicionarEnlaces.setBackground(new java.awt.Color(0,0,0,200));
        AdicionarEnlaces.setEnabled(false);
        AdicionarEnlaces.setMinimumSize(new java.awt.Dimension(900, 934));
        AdicionarEnlaces.setName("AdicionarEnlaces"); // NOI18N
        AdicionarEnlaces.setLayout(null);

        jPanel2.setBackground(new java.awt.Color(49, 49, 49));
        jPanel2.setLayout(null);

        AdicionarEnlaceButton.setBackground(new java.awt.Color(51, 51, 51));
        AdicionarEnlaceButton.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        AdicionarEnlaceButton.setForeground(new java.awt.Color(255, 255, 255));
        AdicionarEnlaceButton.setText("Adicionar");
        AdicionarEnlaceButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AdicionarEnlaceButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                AdicionarEnlaceButtonMouseClicked(evt);
            }
        });
        AdicionarEnlaceButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AdicionarEnlaceButtonActionPerformed(evt);
            }
        });
        jPanel2.add(AdicionarEnlaceButton);
        AdicionarEnlaceButton.setBounds(80, 300, 250, 40);

        ButtonCancel1.setBackground(new java.awt.Color(51, 51, 51));
        ButtonCancel1.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        ButtonCancel1.setForeground(new java.awt.Color(255, 255, 255));
        ButtonCancel1.setText("Cancelar");
        ButtonCancel1.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        ButtonCancel1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ButtonCancel1MouseClicked(evt);
            }
        });
        ButtonCancel1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ButtonCancel1ActionPerformed(evt);
            }
        });
        jPanel2.add(ButtonCancel1);
        ButtonCancel1.setBounds(380, 300, 250, 40);

        Hops.setEditable(false);
        Hops.setBackground(new java.awt.Color(204, 204, 204));
        Hops.setForeground(new java.awt.Color(0, 0, 0));
        Hops.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat(""))));
        Hops.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        Hops.setText("1");
        Hops.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        jPanel2.add(Hops);
        Hops.setBounds(460, 170, 170, 40);

        HopsLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        HopsLabel.setForeground(new java.awt.Color(255, 255, 255));
        HopsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        HopsLabel.setText("Hops");
        jPanel2.add(HopsLabel);
        HopsLabel.setBounds(460, 140, 170, 22);

        CidadeCity1.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        CidadeCity1.setForeground(new java.awt.Color(255, 255, 255));
        CidadeCity1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        CidadeCity1.setText("Cidade");
        jPanel2.add(CidadeCity1);
        CidadeCity1.setBounds(10, 40, 300, 22);

        CidadeCity2.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        CidadeCity2.setForeground(new java.awt.Color(255, 255, 255));
        CidadeCity2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        CidadeCity2.setText("Cidade");
        jPanel2.add(CidadeCity2);
        CidadeCity2.setBounds(340, 40, 300, 22);

        SiglaCity2.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        SiglaCity2.setForeground(new java.awt.Color(255, 255, 255));
        SiglaCity2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        SiglaCity2.setText("Sigla");
        jPanel2.add(SiglaCity2);
        SiglaCity2.setBounds(340, 80, 300, 22);

        Distancia.setBackground(new java.awt.Color(204, 204, 204));
        Distancia.setForeground(new java.awt.Color(0, 0, 0));
        Distancia.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat(""))));
        Distancia.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        Distancia.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        Distancia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                DistanciaActionPerformed(evt);
            }
        });
        jPanel2.add(Distancia);
        Distancia.setBounds(60, 170, 170, 40);

        Custo.setBackground(new java.awt.Color(204, 204, 204));
        Custo.setForeground(new java.awt.Color(0, 0, 0));
        Custo.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat(""))));
        Custo.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        Custo.setFont(new java.awt.Font("Dialog", 0, 18)); // NOI18N
        jPanel2.add(Custo);
        Custo.setBounds(260, 170, 170, 40);

        SiglaCity1.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        SiglaCity1.setForeground(new java.awt.Color(255, 255, 255));
        SiglaCity1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        SiglaCity1.setText("Sigla");
        jPanel2.add(SiglaCity1);
        SiglaCity1.setBounds(10, 80, 300, 22);

        DistanciaLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        DistanciaLabel.setForeground(new java.awt.Color(255, 255, 255));
        DistanciaLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        DistanciaLabel.setText("Distância (KM)");
        jPanel2.add(DistanciaLabel);
        DistanciaLabel.setBounds(60, 140, 170, 22);

        CuatoLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        CuatoLabel.setForeground(new java.awt.Color(255, 255, 255));
        CuatoLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        CuatoLabel.setText("Custo");
        jPanel2.add(CuatoLabel);
        CuatoLabel.setBounds(260, 140, 170, 22);

        AdicionarEnlaces.add(jPanel2);
        jPanel2.setBounds(110, 170, 670, 370);

        getContentPane().add(AdicionarEnlaces);
        AdicionarEnlaces.setBounds(0, -50, 900, 980);
        AdicionarEnlaces.setVisible(false);

        BackgroundMap.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/mapa_esse.png"))); // NOI18N
        BackgroundMap.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        BackgroundMap.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
        getContentPane().add(BackgroundMap);
        BackgroundMap.setBounds(0, -60, 900, 1330);

        SuperiorMenu.setBackground(new java.awt.Color(51, 51, 51));
        SuperiorMenu.setBorder(null);
        SuperiorMenu.setForeground(new java.awt.Color(255, 255, 255));
        SuperiorMenu.setPreferredSize(new java.awt.Dimension(900, 30));

        PontosMenu.setBackground(new java.awt.Color(51, 51, 51));
        PontosMenu.setForeground(new java.awt.Color(255, 255, 255));
        PontosMenu.setText("Pontos");
        PontosMenu.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        PontosMenu.setEnabled(false);
        PontosMenu.setFont(new java.awt.Font("Dialog", 0, 14)); // NOI18N
        PontosMenu.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        PontosMenu.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                PontosMenuMouseClicked(evt);
            }
        });

        AddPontos.setBackground(new java.awt.Color(51, 51, 51));
        AddPontos.setForeground(new java.awt.Color(255, 255, 255));
        AddPontos.setText("Habilitar adição de pontos");
        AddPontos.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AddPontos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AddPontosActionPerformed(evt);
            }
        });
        PontosMenu.add(AddPontos);

        RemovePontos.setBackground(new java.awt.Color(51, 51, 51));
        RemovePontos.setForeground(new java.awt.Color(255, 255, 255));
        RemovePontos.setText("Habilitar remoção de pontos");
        RemovePontos.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        RemovePontos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                RemovePontosMouseClicked(evt);
            }
        });
        RemovePontos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                RemovePontosActionPerformed(evt);
            }
        });
        PontosMenu.add(RemovePontos);

        SuperiorMenu.add(PontosMenu);

        EnlacesMenu.setBackground(new java.awt.Color(51, 51, 51));
        EnlacesMenu.setForeground(new java.awt.Color(255, 255, 255));
        EnlacesMenu.setText("Enlaces");
        EnlacesMenu.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        EnlacesMenu.setEnabled(false);
        EnlacesMenu.setFont(new java.awt.Font("Dialog", 0, 14)); // NOI18N
        EnlacesMenu.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);

        AddEnlaces.setBackground(new java.awt.Color(51, 51, 51));
        AddEnlaces.setForeground(new java.awt.Color(255, 255, 255));
        AddEnlaces.setText("Habilitar adição de enlaces");
        AddEnlaces.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AddEnlaces.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AddEnlacesActionPerformed(evt);
            }
        });
        EnlacesMenu.add(AddEnlaces);

        RemoveEnlaces.setBackground(new java.awt.Color(51, 51, 51));
        RemoveEnlaces.setForeground(new java.awt.Color(255, 255, 255));
        RemoveEnlaces.setText("Habilitar remoção de enlaces");
        RemoveEnlaces.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        RemoveEnlaces.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                RemoveEnlacesActionPerformed(evt);
            }
        });
        EnlacesMenu.add(RemoveEnlaces);

        SuperiorMenu.add(EnlacesMenu);

        CaminhoMinimo.setBackground(new java.awt.Color(51, 51, 51));
        CaminhoMinimo.setForeground(new java.awt.Color(255, 255, 255));
        CaminhoMinimo.setText("Caminho Mínimo");
        CaminhoMinimo.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        CaminhoMinimo.setEnabled(false);
        CaminhoMinimo.setFont(new java.awt.Font("Dialog", 0, 14)); // NOI18N
        CaminhoMinimo.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);

        AplicarDistancia.setBackground(new java.awt.Color(51, 51, 51));
        AplicarDistancia.setForeground(new java.awt.Color(255, 255, 255));
        AplicarDistancia.setText("Percorrer caminho mínimo com DISTANCIA");
        AplicarDistancia.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AplicarDistancia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AplicarDistanciaActionPerformed(evt);
            }
        });
        CaminhoMinimo.add(AplicarDistancia);

        AplicarCusto.setBackground(new java.awt.Color(51, 51, 51));
        AplicarCusto.setForeground(new java.awt.Color(255, 255, 255));
        AplicarCusto.setText("Percorrer caminho mínimo com CUSTO");
        AplicarCusto.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AplicarCusto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AplicarCustoActionPerformed(evt);
            }
        });
        CaminhoMinimo.add(AplicarCusto);

        AplicarHops.setBackground(new java.awt.Color(51, 51, 51));
        AplicarHops.setForeground(new java.awt.Color(255, 255, 255));
        AplicarHops.setText("Percorrer caminho mínimo com HOPS");
        AplicarHops.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        AplicarHops.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AplicarHopsActionPerformed(evt);
            }
        });
        CaminhoMinimo.add(AplicarHops);

        SuperiorMenu.add(CaminhoMinimo);

        ReportErro.setBackground(new java.awt.Color(51, 51, 51));
        ReportErro.setForeground(new java.awt.Color(255, 255, 255));
        ReportErro.setText("Erro");
        ReportErro.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        ReportErro.setEnabled(false);
        ReportErro.setFont(new java.awt.Font("Dialog", 0, 14)); // NOI18N
        ReportErro.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        ReportErro.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ReportErroMouseClicked(evt);
            }
        });
        ReportErro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ReportErroActionPerformed(evt);
            }
        });

        ErroPonto.setBackground(new java.awt.Color(51, 51, 51));
        ErroPonto.setForeground(new java.awt.Color(255, 255, 255));
        ErroPonto.setText("Reportar erro/ajuste em ponto");
        ErroPonto.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        ErroPonto.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ErroPontoMouseClicked(evt);
            }
        });
        ErroPonto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ErroPontoActionPerformed(evt);
            }
        });
        ReportErro.add(ErroPonto);

        ErroEnlace.setBackground(new java.awt.Color(51, 51, 51));
        ErroEnlace.setForeground(new java.awt.Color(255, 255, 255));
        ErroEnlace.setText("Reportar erro/ajuste em enlace");
        ErroEnlace.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        ErroEnlace.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ErroEnlaceMouseClicked(evt);
            }
        });
        ErroEnlace.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ErroEnlaceActionPerformed(evt);
            }
        });
        ReportErro.add(ErroEnlace);

        SuperiorMenu.add(ReportErro);

        SobreMenu.setBackground(new java.awt.Color(51, 51, 51));
        SobreMenu.setForeground(new java.awt.Color(255, 255, 255));
        SobreMenu.setText("Sobre");
        SobreMenu.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        SobreMenu.setFont(new java.awt.Font("Dialog", 0, 14)); // NOI18N
        SobreMenu.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        SobreMenu.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                SobreMenuMouseClicked(evt);
            }
        });
        SuperiorMenu.add(SobreMenu);

        setJMenuBar(SuperiorMenu);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void initComponents2(){
        //Capturando grafico inicial para conseguir serem feitas as alterações a partir de um segundo grafico
        //Executando JFrame no meio da tela
        Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
        this.setLocation(dim.width/2-this.getSize().width/2,dim.height/2-this.getSize().height/2);
        universal_graph =  Map.getGraphics();
        
        //Ao Scroll vertical ser soltado, renovar mapa.
        JScrollMap.getVerticalScrollBar().addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseReleased(java.awt.event.MouseEvent evt) {
                    resetMapOnly();
                }
        });
        
        this.addWindowListener(new WindowAdapter(){
            @Override
            public void windowActivated(WindowEvent we){
                resetMapOnly();
            }
        });
        sobre = new Sobre();
        
    }
    
    private void initVertices(){
        //Adicionando os vertices ao grafico
        atualizarConexoes();
        this.arrayPoints = new ArrayList();
        List<Vertice> vertices = app.getTodasCidades();
        for (int i=0; i<vertices.size(); i++) {
            addPoint(vertices.get(i));
        }
    }
    
    private void initConections(){
        //Adicionando conexões ao gráfico
        atualizarConexoes();
        this.arrayLines = new ArrayList();
        for (int i=0; i<this.conexoes.size(); i++) {
            addAresta(this.conexoes.get(i));
        }
    }
    
    private void addAresta(Aresta aresta){
        Lines line = new Lines(aresta);
        this.arrayLines.add(line);
    }
    
    void addPoint(Vertice vertice){
        //Cria objeto point e adiciona na lista de pontos
        Point point = new Point(vertice);
        arrayPoints.add(point);
    }
    
    private void resetGraph(){
        //Irá resetar o grafico, removendo arestas
        universal_graph = Map.getGraphics();
        Map.paint(Map.getGraphics());
    }
    
    void resetMapOnly(){
        this.Map.removeAll();
        resetGraph();
        for (int i=0; i<arrayPoints.size(); i++) {
            this.Map.add(arrayPoints.get(i).getPainelPrincipal());
        }
        for (int i=0; i<arrayLines.size(); i++) {
            arrayLines.get(i).desenharLinha();
        }
        Map.paintComponents(universal_graph);
    }
    
    private void setClick(){
        //Adiciona um click, contabilizando os clicks em vértices
        this.clicks +=1;
    }
    
    private ArrayList<String> search_city(int x, int y) throws Exception{
        //Realiza os cálculos de longitude e latitude e procura as cidades
        System.out.println(x + "," + y);
        ArrayList<String>  names_city = new ArrayList();
        double latitude = 5.48155495 + (y*-0.04885256);
        double longitude = -74.28821548 + (x*0.04895532);
        try {
            names_city = viewTable(latitude, longitude);
        } catch (SQLException ex) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
            System.out.println(ex);
        }
        return names_city;
    }
    
    private void LigarDesligarJanelas(String nome, boolean superiorMenuAtivo){
        this.SuperiorMenu.setVisible(superiorMenuAtivo);
        
        if(nome == "JScrollMap"){
            this.AdicionarEnlaces.setVisible(false);
            this.AdicionarPontos.setVisible(false);
            this.JScrollMap.setVisible(true);
        }else if(nome == "AdicionarEnlaces"){
            this.AdicionarPontos.setVisible(false);
            this.JScrollMap.setVisible(false);
            this.AdicionarEnlaces.setVisible(true);
        }else if(nome == "AdicionarPontos"){
            this.JScrollMap.setVisible(false);
            this.AdicionarEnlaces.setVisible(false);
            this.AdicionarPontos.setVisible(true);
        }
        
        
    }
    
    private void addLinhaAresta(){
        //Adiciona linha de aresta a partir dos cliques

        if(this.clicks == 2){
            this.AdicionarEnlaces.setVisible(true);
            this.AdicionarPontos.setVisible(false);
            this.SuperiorMenu.setVisible(false);
            this.JScrollMap.setVisible(false);
            
            this.Distancia.setText("");
            this.Custo.setText("");
            this.Hops.setText("");

            this.CidadeCity1.setText(this.vertice_old.getNomeCidade());
            this.CidadeCity2.setText(this.vertice_now.getNomeCidade());

            this.SiglaCity1.setText(this.vertice_old.getSigla());
            this.SiglaCity2.setText(this.vertice_now.getSigla());
        }
    }

    
    private void configClicks(Vertice vertice){
        if(this.clicks == 1){
            this.vertice_old = vertice;
        }
        if(this.clicks == 2){
            this.vertice_now = vertice;
        }
    }
    

    
    private void ButtonCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ButtonCancelActionPerformed
        //Adiciona novo ponto ao grafico a partir da entrada do usuário
        this.AdicionarEnlaces.setVisible(false);
        this.AdicionarPontos.setVisible(false);
        this.SuperiorMenu.setVisible(true);
        this.JScrollMap.setVisible(true);
        JOptionPane.showMessageDialog(null, "Operação cancelada com sucesso!");
        resetMap();
        
    }//GEN-LAST:event_ButtonCancelActionPerformed

    private void ComboCitysActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ComboCitysActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ComboCitysActionPerformed

    private void MapKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_MapKeyPressed

    }//GEN-LAST:event_MapKeyPressed

    private void MapMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_MapMouseClicked
        //Se permitida a inserção de ponto por clique, dará as opções de cidades para adição dos pontos
        if(this.allow_add_points){
            this.x_now =evt.getX();
            this.y_now=evt.getY();
            int limite = 0;
            ArrayList<String> names_city = new ArrayList();
            try {
                names_city = search_city(this.x_now, this.y_now);
            } catch (Exception ex) {
                Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
            }
            
            if(names_city.size() > 10){limite = 10;}
            else{limite = names_city.size();}

            ComboCitys.removeAllItems();
            for (int i=0;i<limite;i++){
                ComboCitys.addItem(names_city.get(i));
            }

            this.AdicionarEnlaces.setVisible(false);
            this.AdicionarPontos.setVisible(true);
            this.SiglaAdd.setText("");
            this.SuperiorMenu.setVisible(false);
            this.JScrollMap.setVisible(false);
            resetMap();
        }
        
    }//GEN-LAST:event_MapMouseClicked

    private void MapMouseWheelMoved(java.awt.event.MouseWheelEvent evt) {//GEN-FIRST:event_MapMouseWheelMoved
        // TODO add your handling code here:
    }//GEN-LAST:event_MapMouseWheelMoved

    private void PontosMenuMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_PontosMenuMouseClicked
        
    }//GEN-LAST:event_PontosMenuMouseClicked

    private void AddPontosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AddPontosActionPerformed
        //Permitindo o clique para adição de novo ponto
        if(!this.allow_add_points){
            this.allow_add_points = true;
            AddPontos.setText("Desabilitar adição de pontos");
            
            EnlacesMenu.setEnabled(false);
            ReportErro.setEnabled(false);
            CaminhoMinimo.setEnabled(false);
            
            RemovePontos.setEnabled(false);
        }else{
            this.allow_add_points = false;
            AddPontos.setText("Habilitar adição de pontos");
            
            EnlacesMenu.setEnabled(true);
            ReportErro.setEnabled(true);
            CaminhoMinimo.setEnabled(true);
            
            RemovePontos.setEnabled(true);
        }
    }//GEN-LAST:event_AddPontosActionPerformed

    private void AdicionarPontosButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AdicionarPontosButtonActionPerformed
        this.Map.repaint();
        this.Map.removeAll();
        
        try {
            this.app.cadastrarCidade(ComboCitys.getSelectedItem().toString(), SiglaAdd.getText(), this.x_now, this.y_now);
        } catch (Exception ex) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
        }
        
        this.AdicionarEnlaces.setVisible(false);
        this.AdicionarPontos.setVisible(false);
        this.SuperiorMenu.setVisible(true);
        this.JScrollMap.setVisible(true);
        JOptionPane.showMessageDialog(null,"Adicionado com sucesso!");
        resetMap(); 
    }//GEN-LAST:event_AdicionarPontosButtonActionPerformed

    private void ButtonCancelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ButtonCancelMouseClicked
        //Cancelando operação de adição de novo ponto
        LigarDesligarJanelas("JScrollPane", true);
        JOptionPane.showMessageDialog(null,"Operação cancelada com sucesso!");
        resetMap();
    }//GEN-LAST:event_ButtonCancelMouseClicked

    private void ListarMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ListarMouseClicked
        this.EnlacesMenu.setEnabled(true);
        this.PontosMenu.setEnabled(true);
        this.Listar.setVisible(false);
        this.ReportErro.setEnabled(true);
        this.CaminhoMinimo.setEnabled(true);
        this.JScrollMap.getVerticalScrollBar().setEnabled(true);
        this.Map.setEnabled(true);
        JOptionPane.showMessageDialog(null, "Mapa iniciado!");
        atualizarConexoes();
        resetMap();
    }//GEN-LAST:event_ListarMouseClicked

    private void MapMouseMoved(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_MapMouseMoved
        // TODO add your handling code here:
    }//GEN-LAST:event_MapMouseMoved

    private void AdicionarPontosButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_AdicionarPontosButtonMouseClicked
               
    }//GEN-LAST:event_AdicionarPontosButtonMouseClicked

    private void RemovePontosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_RemovePontosMouseClicked
        
    }//GEN-LAST:event_RemovePontosMouseClicked

    private void RemovePontosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_RemovePontosActionPerformed
        //Permitindo o clique para adição de novo ponto
        if(!this.allow_remove_points){
            this.allow_remove_points = true;
            RemovePontos.setText("Desabilitar remoção de pontos");
            
            
            EnlacesMenu.setEnabled(false);
            ReportErro.setEnabled(false);
            CaminhoMinimo.setEnabled(false);
            
            AddPontos.setEnabled(false);
        }else{
            this.allow_remove_points = false;
            RemovePontos.setText("Habilitar remoção de pontos");
            EnlacesMenu.setEnabled(true);
            ReportErro.setEnabled(true);
            CaminhoMinimo.setEnabled(true);
            
            AddPontos.setEnabled(true);
        }
        
    }//GEN-LAST:event_RemovePontosActionPerformed

    private void AdicionarEnlaceButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_AdicionarEnlaceButtonMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_AdicionarEnlaceButtonMouseClicked

    private void AdicionarEnlaceButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AdicionarEnlaceButtonActionPerformed
        try {
            this.app.cadastrarConexao(this.vertice_old, this.vertice_now, Integer.parseInt(Distancia.getText()), Integer.parseInt(Custo.getText()));
        } catch (Exception ex) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
        }
        this.clicks = 0;
        
        this.AdicionarEnlaces.setVisible(false);
        this.AdicionarPontos.setVisible(false);
        this.SuperiorMenu.setVisible(true);
        this.JScrollMap.setVisible(true);
        JOptionPane.showMessageDialog(null,"Adicionado com sucesso!");
        resetMap();
    }//GEN-LAST:event_AdicionarEnlaceButtonActionPerformed

    private void ButtonCancel1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ButtonCancel1MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ButtonCancel1MouseClicked

    private void ButtonCancel1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ButtonCancel1ActionPerformed
        this.clicks = 0;
        this.AdicionarEnlaces.setVisible(false);
        this.AdicionarPontos.setVisible(false);
        this.SuperiorMenu.setVisible(true);
        this.JScrollMap.setVisible(true);
        JOptionPane.showMessageDialog(null,"Operação Cancelada");
        resetMap();
        
    }//GEN-LAST:event_ButtonCancel1ActionPerformed

    private void DistanciaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_DistanciaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_DistanciaActionPerformed

    private void AddEnlacesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AddEnlacesActionPerformed
        //Permitindo o clique para adição de novo ponto
        if(!this.allow_add_conexion){
            
            this.allow_add_conexion = true;
            AddEnlaces.setText("Desabilitar adição de enlaces");
            
            PontosMenu.setEnabled(false);
            ReportErro.setEnabled(false);
            CaminhoMinimo.setEnabled(false);
            
            RemoveEnlaces.setEnabled(false);
            
        }else{
            this.allow_add_conexion = false;
            AddEnlaces.setText("Habilitar adição de enlaces");
            
            PontosMenu.setEnabled(true);
            ReportErro.setEnabled(true);
            CaminhoMinimo.setEnabled(true);
            
            RemoveEnlaces.setEnabled(true);
        }
    }//GEN-LAST:event_AddEnlacesActionPerformed

    private void AplicarCustoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AplicarCustoActionPerformed
        if(!this.allow_do_way_minimum){
            this.allow_do_way_minimum = true;
            this.allow_add_conexion = false;
            AplicarCusto.setText("Parar de percorrer caminho mínimo");
            this.metrica = MetricaCalculo.CUSTO;
            
            AplicarHops.setEnabled(false);
            AplicarDistancia.setEnabled(false);
            ReportErro.setEnabled(false);
            
            EnlacesMenu.setEnabled(false);
            
        }else{
            this.allow_do_way_minimum = false;
            AplicarCusto.setText("Percorrer caminho mínimo com CUSTO");
            AplicarHops.setEnabled(true);
            AplicarDistancia.setEnabled(true);
            ReportErro.setEnabled(true);
            EnlacesMenu.setEnabled(true);
        }
    }//GEN-LAST:event_AplicarCustoActionPerformed

    private void AplicarHopsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AplicarHopsActionPerformed
        if(!this.allow_do_way_minimum){
            this.allow_do_way_minimum = true;
            this.allow_add_conexion = false;
            AplicarHops.setText("Parar de percorrer caminho mínimo");
            this.metrica = MetricaCalculo.SALTO;
            
            AplicarDistancia.setEnabled(false);
            AplicarCusto.setEnabled(false);
            ReportErro.setEnabled(false);
            
            EnlacesMenu.setEnabled(false);
            
        }else{
            this.allow_do_way_minimum = false;
            AplicarHops.setText("Percorrer caminho mínimo com HOPS");
            AplicarDistancia.setEnabled(true);
            AplicarCusto.setEnabled(true);
            EnlacesMenu.setEnabled(true);
            ReportErro.setEnabled(true);
        }
    }//GEN-LAST:event_AplicarHopsActionPerformed

    private void ErroEnlaceMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ErroEnlaceMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ErroEnlaceMouseClicked

    private void ErroEnlaceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ErroEnlaceActionPerformed
        if(!this.allow_report_erro_enlace){
            this.allow_report_erro_enlace = true;
            EnlacesMenu.setEnabled(false);
            PontosMenu.setEnabled(false);
            CaminhoMinimo.setEnabled(false);
            
            ErroPonto.setEnabled(false);
            
            ErroEnlace.setText("Desabilitar reporte de erro/ajuste enlace");
            
        }else{
            this.allow_report_erro_enlace = false;
            EnlacesMenu.setEnabled(true);
            PontosMenu.setEnabled(true);
            CaminhoMinimo.setEnabled(true);
            
            ErroPonto.setEnabled(true);
            
            ErroEnlace.setText("Reportar erro/ajuste em enlace");
        }
    }//GEN-LAST:event_ErroEnlaceActionPerformed

    private void ErroPontoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ErroPontoMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ErroPontoMouseClicked

    private void ErroPontoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ErroPontoActionPerformed
        if(!this.allow_report_erro_point){
            this.allow_report_erro_point = true;
            EnlacesMenu.setEnabled(false);
            PontosMenu.setEnabled(false);
            CaminhoMinimo.setEnabled(false);
            
            ErroEnlace.setEnabled(false);
            
            ErroPonto.setText("Desabilitar reporte de erro/ajuste ponto");
            
        }else{
            this.allow_report_erro_point = false;
            EnlacesMenu.setEnabled(true);
            PontosMenu.setEnabled(true);
            CaminhoMinimo.setEnabled(true);
            
            ErroEnlace.setEnabled(true);
            
            ErroPonto.setText("Reportar erro/ajuste em ponto");
        }
        
    }//GEN-LAST:event_ErroPontoActionPerformed

    private void ReportErroMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ReportErroMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ReportErroMouseClicked

    private void ReportErroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ReportErroActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ReportErroActionPerformed

    private void RemoveEnlacesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_RemoveEnlacesActionPerformed
        if(!this.allow_remove_conexion){
            
            this.allow_remove_conexion = true;
            RemoveEnlaces.setText("Desabilitar remoção de enlaces");
            
            PontosMenu.setEnabled(false);
            ReportErro.setEnabled(false);
            CaminhoMinimo.setEnabled(false);
            
            AddEnlaces.setEnabled(false);
            
        }else{
            this.allow_remove_conexion = false;
            RemoveEnlaces.setText("Habilitar remoção de enlaces");
            
            PontosMenu.setEnabled(true);
            ReportErro.setEnabled(true);
            CaminhoMinimo.setEnabled(true);
            
            AddEnlaces.setEnabled(true);
        }
    }//GEN-LAST:event_RemoveEnlacesActionPerformed

    private void JScrollMapMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_JScrollMapMouseClicked
        System.out.println("alo");
    }//GEN-LAST:event_JScrollMapMouseClicked

    private void JScrollMapMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_JScrollMapMouseReleased
        resetMap();
    }//GEN-LAST:event_JScrollMapMouseReleased

    private void SobreMenuMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_SobreMenuMouseClicked
        this.sobre.setVisible(true);
        Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
        sobre.setLocation(dim.width/2-sobre.getSize().width/2,dim.height/2-sobre.getSize().height/2);
    }//GEN-LAST:event_SobreMenuMouseClicked

    private void AplicarDistanciaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AplicarDistanciaActionPerformed
        if(!this.allow_do_way_minimum){
            this.allow_do_way_minimum = true;
            this.allow_add_conexion = false;
            AplicarDistancia.setText("Parar de percorrer caminho mínimo");
            this.metrica = MetricaCalculo.DISTANCIA;
            
            AplicarHops.setEnabled(false);
            AplicarCusto.setEnabled(false);
            ReportErro.setEnabled(false);
            
            EnlacesMenu.setEnabled(false);
            
        }else{
            this.allow_do_way_minimum = false;
            AplicarDistancia.setText("Percorrer caminho mínimo com DISTANCIA");
            AplicarHops.setEnabled(true);
            AplicarCusto.setEnabled(true);
            ReportErro.setEnabled(true);
            EnlacesMenu.setEnabled(true);
        }
    }//GEN-LAST:event_AplicarDistanciaActionPerformed
    
    private void fazerCaminhoMinimo(){
        if(this.allow_do_way_minimum){
            if(this.clicks == 2){
                this.clicks = 0;
                ResultCaminho rc = null;
                List<Vertice> verticesResult = null;
                Vertice olderVertice = null;
                Vertice newVertice = null;

                try {
                    rc = this.app.bellmanFord(this.vertice_old, this.vertice_now, this.metrica);
                    verticesResult = rc.getVertice();
                    for (int i=0; i<verticesResult.size();i++){
                        if(i > 0){
                            newVertice = verticesResult.get(i);
                            olderVertice = verticesResult.get(i-1);
                            ((Graphics2D)universal_graph).setColor(Color.GREEN);
                            ((Graphics2D)universal_graph).setStroke(new BasicStroke(3));
                            Line2D.Float line = new Line2D.Float(olderVertice.getCordenadaX(), olderVertice.getCordenadaY(), newVertice.getCordenadaX(), newVertice.getCordenadaY());
                            ((Graphics2D)universal_graph).draw(line);
                        }
                    }
                    JOptionPane.showMessageDialog(null, "Para a métrica utilizada: " + rc.getValorPercorrido());
                } catch (Exception ex) {
                    JOptionPane.showMessageDialog(null, "Ops... Acho que estes pontos não se dão muito bem rs");
                }
                resetMap();
            }
      }  
    }
    
    private void reportarErroCaminho(){
        if(this.allow_report_erro_enlace){
            if(this.clicks == 2){
                this.clicks = 0;
                try {
                    this.app.alterarStatusConexao(procurarArestaPorVertices());
                    JOptionPane.showMessageDialog(null, "Erro/Ajuste reportado com sucesso!");
                } catch (Exception ex) {
                    JOptionPane.showMessageDialog(null, "Tente novamente, este enlace não existe!");
                }
                
                atualizarConexoes();
                resetMap();
            }
        }
    }
    
    
    private void removerAresta(){
        if(this.allow_remove_conexion){
            if(this.clicks == 2){
                try {
                    this.app.excluirConexao(procurarArestaPorVertices());
                    JOptionPane.showMessageDialog(null, "Enlace removida com sucesso!");
                    this.clicks = 0;
                    atualizarConexoes();
                } catch (Exception ex) {
                    JOptionPane.showMessageDialog(null, "Tentando excluir enlaces não existentes?");
                }
                resetMap();
            }
        }
    }
    
    private Aresta procurarArestaPorVertices(){
        for (int i=0;i<this.conexoes.size();i++){
            if(this.conexoes.get(i).getOrigem().getIdCidade() == this.vertice_old.getIdCidade() & this.conexoes.get(i).getDestino().getIdCidade() == this.vertice_now.getIdCidade()){
                try {
                    return this.conexoes.get(i);
                } catch (Exception ex) {
                    Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                }
            }else if(this.conexoes.get(i).getOrigem().getIdCidade() == this.vertice_now.getIdCidade() & this.conexoes.get(i).getDestino().getIdCidade() == this.vertice_old.getIdCidade()){
                try {
                    return this.conexoes.get(i);
                } catch (Exception ex) {
                    Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }
        return null;
    }
    
    
    
    private void atualizarConexoes(){
        try {
            //Inicializando e mostrando grafo.
            this.app.buscarCidades();
            this.app.buscarConexoes();
        } catch (Exception ex) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
        }
        this.conexoes = this.app.getTodasConexoes();
    }
    
    private void resetMap(){
        this.Map.removeAll();
        resetGraph();
        initVertices();
        initConections();
        Map.paintComponents(universal_graph);
    }
    
    
    public ArrayList<String> viewTable(double latitude , double longitude) throws Exception {
        //Após a identificação da latitude e longitude, recolhe as cidades mais próximas das quais foi clicado.
        ArrayList<String> names_citys_around = new ArrayList();    
    
        double compare = 3;
        double latitude_max = latitude + compare;
        double latitude_min = latitude - compare;
        double longitude_max = longitude + compare;
        double longitude_min = longitude - compare;

        String query = "select * from municipios WHERE latitude BETWEEN " + latitude_min + " and " + latitude_max + "" + " and " +
                "longitude BETWEEN " + longitude_min + " and " + longitude_max + "";

        ResultSet rs = this.conn.buscar(query);
        while (rs.next()) {
          String nome = rs.getString("nome");
          names_citys_around.add(nome);
        }
        return names_citys_around;
    }
    public static void main(String args[]) throws Exception {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Windows Classic".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Principal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        // create our mysql database connection
        //</editor-fold>

        // create our mysql database connection
        
        
        /* Create and display the form */
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    new Principal().setVisible(true);
                    
                } catch (ClassNotFoundException | SQLException ex) {
                    Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                } catch (Exception ex) {
                    Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        });
    }
    
    class Point{
        //Classe de pontos, nos diz a respeito do vértice, mas armazenando suas propriedades para que possamos mudar ou excluir durante a vontade do usuário.
        private int coordinates_x = 0;
        private int coordinates_y = 0;
        private String name = "";
        private int id_cidade = 0;
        private javax.swing.JPanel princ; //Painel que armazena o ponto e sua sigla
        private javax.swing.JLabel princ_point; //Label que representa o pontp
        Vertice vertice_now;
        boolean status = true;
        String imageMouseEntered, imageMouseReleased;
        
        Point(Vertice vertice){
            princ = new javax.swing.JPanel();
            princ_point = new javax.swing.JLabel();
            this.vertice_now = vertice;
            status = vertice.getAtivo();
            
            //Configurando imagens baseado no status
            if(status){
                imageMouseEntered = "/imgs/activated_point_mouseon.png";
                imageMouseReleased = "/imgs/activated_point.png";
            }else{
                imageMouseEntered = "/imgs/deactivated_point_mouseon.png";
                imageMouseReleased = "/imgs/deactivated_point_mouseoff.png";
            }
            
            int tam_img = 20; //Tamanho da imagem referentes ao ponto
            
            //Armazenando informações principais do vertice
            this.coordinates_x = vertice.getCordenadaX();
            this.coordinates_y = vertice.getCordenadaY();
            this.name = vertice.getNomeCidade();
            this.id_cidade = vertice.getIdCidade();
            
            //Calculando as coordenadas do X, Y do Painel
            int x_locate = (coordinates_x-tam_img); 
            int y_locate = (coordinates_y-tam_img/2)-tam_img;
            
            //Configurando JLabel, que mostra a sigla do ponto
            javax.swing.JLabel label_name = new javax.swing.JLabel();
            label_name.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
            label_name.setForeground(new java.awt.Color(255, 255, 255));
            label_name.setText(vertice.getSigla());
            label_name.setBounds(10, 0, 190, 19);
            label_name.setVisible(true);
            princ.add(label_name);
            
            //Configurando Ponto em si
            princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource(imageMouseReleased)));
            princ_point.setLayout(null);
            princ_point.setBounds(10, 20, tam_img, tam_img);
            princ_point.setVisible(true);
            
            //Configurando Painel principal
            princ.setBounds(x_locate, y_locate, tam_img*2, tam_img*2);
            princ.setVisible(true);
            princ.setOpaque(false);
            princ.setLayout(null);
            
            princ.add(princ_point);
            
            
            //Quando o mouse passa por cima do ponto
            princ_point.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseEntered(java.awt.event.MouseEvent evt) {
                    if(!allow_do_way_minimum&!allow_report_erro_enlace){
                        princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource(imageMouseEntered)));
                    }
                    princ_point.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
                }
            });
            
            //Quando o mouse sai de cima do ponto
            princ_point.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseExited(java.awt.event.MouseEvent evt) {
                    if(!allow_do_way_minimum&!allow_report_erro_enlace){
                        princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource(imageMouseReleased)));
                    }
                }
            });
            
            //Quando o mouse é clicado
            princ_point.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseClicked(java.awt.event.MouseEvent evt) {
                    System.out.println(name);
                    
                    if(allow_add_conexion){
                        setClick();
                        configClicks(vertice_now);
                        addLinhaAresta();
                    }
                    
                    if(allow_do_way_minimum){
                        setClick();
                        configClicks(vertice_now);
                        fazerCaminhoMinimo();
                    }
                    
                    if(allow_report_erro_enlace){
                        try {
                            setClick();
                            configClicks(vertice_now);
                            reportarErroCaminho();
                        } catch (Exception ex) {
                            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                        }
                    }
                    
                    if(allow_remove_conexion){
                        try {
                            setClick();
                            configClicks(vertice_now);
                            removerAresta();
                            princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/deactivated_point_mouseoff.png")));
                        } catch (Exception ex) {
                            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                        }
                        resetMap();
                    }
                    
                    if(allow_report_erro_point){
                        try {
                            app.alterarStatusCidade(vertice_now);
                            status = !status;
                            atualizarConexoes();
                            resetMap();
                        } catch (Exception ex) {
                            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                        }
                    }
                    
                    if(allow_remove_points){
                        try {
                            app.excluirCidade(vertice_now);
                        } catch (Exception ex) {
                            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, ex);
                        }
                        resetMap();
                    }
                }
            });
            
            //Quando o mouse é pressionado (clicando ou segurando)
            princ_point.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mousePressed(java.awt.event.MouseEvent evt) {
                    if(allow_do_way_minimum){
                        princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/selected_caminho.png")));
                    }else if(allow_report_erro_enlace){
                        princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/deactivated_point_mouseoff.png")));
                        System.out.println("troca");
                    }else{
                        princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imgs/mouse_clicking.png")));
                    }
                }
            });
            
            //Quando o mouse para de ser pressionado
            princ_point.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseReleased(java.awt.event.MouseEvent evt) {
                    if(!allow_do_way_minimum&!allow_report_erro_enlace){
                        princ_point.setIcon(new javax.swing.ImageIcon(getClass().getResource(imageMouseReleased)));   
                    }
                }
            });
            
            //Adicionando o componentes e renovando grafico
            Map.add(princ);
            
        }
        
        public javax.swing.JPanel getPainelPrincipal(){
            return this.princ;
        }
        
        public int getX(){
            return this.coordinates_x;
        }
        
        public int getY(){
            return this.coordinates_y;
        }
        
        public String getName(){
            return this.name;
        }
        
        public int getId(){
            return this.id_cidade;
        }
        
    }
    
class Lines{
    private Aresta aresta = null;
    private final java.awt.Color cor_ativada = java.awt.Color.BLUE;
    private final java.awt.Color cor_desativada = java.awt.Color.RED;
    private final java.awt.Color cor_caminho_minimo = java.awt.Color.GREEN;
    Line2D.Float line = null;
    
    Lines (Aresta aresta){
        this.aresta = aresta;
        desenharLinha();
    }
    
    private void desenharLinha(){
        if(this.aresta.getArestaDisponivel()){
            ((Graphics2D)universal_graph).setColor(cor_ativada);
        }else{
            ((Graphics2D)universal_graph).setColor(cor_desativada);
        }
        ((Graphics2D)universal_graph).setStroke(new BasicStroke(2));
        this.line = new Line2D.Float(aresta.getOrigem().getCordenadaX(), aresta.getOrigem().getCordenadaY(), aresta.getDestino().getCordenadaX(), aresta.getDestino().getCordenadaY());
        ((Graphics2D)universal_graph).draw(this.line);
    }
    
    public Aresta getAresta(){
        return this.aresta;
    }
    
}

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JMenuItem AddEnlaces;
    private javax.swing.JMenuItem AddPontos;
    private javax.swing.JButton AdicionarEnlaceButton;
    private javax.swing.JPanel AdicionarEnlaces;
    private javax.swing.JPanel AdicionarPontos;
    private javax.swing.JButton AdicionarPontosButton;
    private javax.swing.JMenuItem AplicarCusto;
    private javax.swing.JMenuItem AplicarDistancia;
    private javax.swing.JMenuItem AplicarHops;
    private javax.swing.JLabel BackgroundMap;
    private javax.swing.JButton ButtonCancel;
    private javax.swing.JButton ButtonCancel1;
    private javax.swing.JMenu CaminhoMinimo;
    private javax.swing.JLabel CidadeCity1;
    private javax.swing.JLabel CidadeCity2;
    private javax.swing.JComboBox<String> ComboCitys;
    private javax.swing.JLabel CuatoLabel;
    private javax.swing.JFormattedTextField Custo;
    private javax.swing.JFormattedTextField Distancia;
    private javax.swing.JLabel DistanciaLabel;
    private javax.swing.JMenu EnlacesMenu;
    private javax.swing.JMenuItem ErroEnlace;
    private javax.swing.JMenuItem ErroPonto;
    private javax.swing.JFormattedTextField Hops;
    private javax.swing.JLabel HopsLabel;
    private javax.swing.JScrollPane JScrollMap;
    private javax.swing.JButton Listar;
    private javax.swing.JLabel Map;
    private javax.swing.JPanel PanelMap;
    private javax.swing.JMenu PontosMenu;
    private javax.swing.JMenuItem RemoveEnlaces;
    private javax.swing.JMenuItem RemovePontos;
    private javax.swing.JMenu ReportErro;
    private javax.swing.JFormattedTextField SiglaAdd;
    private javax.swing.JLabel SiglaCity1;
    private javax.swing.JLabel SiglaCity2;
    private javax.swing.JMenu SobreMenu;
    private javax.swing.JMenuBar SuperiorMenu;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    // End of variables declaration//GEN-END:variables
}
